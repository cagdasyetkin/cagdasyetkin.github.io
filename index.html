<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Cagdas Yetkin</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="final.html">Final Project</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/cagdasyetkin">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/cagdasyetkin">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/cagdasyetkin/">
    <span class="fa fa-linkedin fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<hr />
<hr />
<p><b> 2018.24.02, 17:40 </b></p>
<p>We are loading the Game of Thrones books. The goal is to check how document term matrix looks like and get the sentiments from the books.</p>
<pre class="r"><code>GoT1 &lt;- readLines(&quot;GoT1.txt&quot;) %&gt;%
  data_frame() %&gt;%
  mutate(title = &quot;A Game of Thrones&quot;)

GoT2 &lt;- readLines(&quot;GoT2.txt&quot;) %&gt;%
  data_frame() %&gt;%
  mutate(title = &quot;A Clash of Kings&quot;) 

GoT3 &lt;- readLines(&quot;GoT3.txt&quot;) %&gt;%
  data_frame() %&gt;%
  mutate(title = &quot;A Storm of Swords&quot;) 

GoT4 &lt;- readLines(&quot;GoT4.txt&quot;) %&gt;%
  data_frame() %&gt;%
  mutate(title = &quot;A Feast of Crows&quot;) 

GoT5 &lt;- readLines(&quot;GoT5.txt&quot;) %&gt;%
  data_frame() %&gt;%
  mutate(title = &quot;A Dance with Dragons&quot;) 

Thrones &lt;- bind_rows(list(GoT1, GoT2, GoT3, GoT4, GoT5)) 
colnames(Thrones) &lt;- c(&quot;text&quot;, &quot;title&quot;)</code></pre>
<p>Converting them to Tidy format</p>
<pre class="r"><code>Tidy_Thrones &lt;- Thrones %&gt;%
  group_by(title) %&gt;%
  ungroup() %&gt;%
  unnest_tokens(word, text) %&gt;%
  mutate(word_stem = wordStem(word)) %&gt;%
  anti_join(stop_words)</code></pre>
<p>Creating a document term matrix</p>
<pre class="r"><code>dtm_words_count &lt;- Tidy_Thrones %&gt;%
  mutate(word_stem = removeNumbers(word_stem)) %&gt;%
  count(title, word_stem, sort = TRUE) %&gt;%
  ungroup() %&gt;%
  filter(word_stem != &quot;&quot;) %&gt;%
  cast_dtm(title, word_stem, n)

dtm_words_count</code></pre>
<pre><code>## &lt;&lt;DocumentTermMatrix (documents: 5, terms: 15856)&gt;&gt;
## Non-/sparse entries: 44721/34559
## Sparsity           : 44%
## Maximal term length: 52
## Weighting          : term frequency (tf)</code></pre>
<p>and checking a few terms…</p>
<pre class="r"><code>terms &lt;- Terms(dtm_words_count)
head(terms)</code></pre>
<p>the word ‘ser’ means ‘sir’ in Game of Thrones novels.</p>
<p>Now get back to tidy format:</p>
<pre class="r"><code>words_count &lt;- tidy(dtm_words_count)</code></pre>
<p>Get the sentiments from bing lexicon:</p>
<pre class="r"><code>GoT_sentiments &lt;- words_count %&gt;%
  inner_join(get_sentiments(&quot;bing&quot;), by = c(term = &quot;word&quot;))

GoT_sentiments</code></pre>
<pre><code>## # A tibble: 4,511 x 4
##    document             term  count sentiment
##    &lt;chr&gt;                &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;    
##  1 A Storm of Swords    dead    404 negative 
##  2 A Dance with Dragons dead    478 negative 
##  3 A Feast of Crows     dead    270 negative 
##  4 A Clash of Kings     dead    328 negative 
##  5 A Game of Thrones    dead    267 negative 
##  6 A Storm of Swords    kill    461 negative 
##  7 A Dance with Dragons kill    324 negative 
##  8 A Feast of Crows     kill    234 negative 
##  9 A Clash of Kings     kill    267 negative 
## 10 A Game of Thrones    kill    190 negative 
## # ... with 4,501 more rows</code></pre>
<p>Terms look just like some song lyrics from a power-metal band.</p>
<p>Can we plot them anyway:</p>
<pre class="r"><code>GoT_sentiments %&gt;%
  count(sentiment, term, wt = count) %&gt;%
  ungroup() %&gt;%
  filter(n &gt;= 1000) %&gt;%
  mutate(n = ifelse(sentiment == &quot;negative&quot;, -n, n)) %&gt;%
  mutate(term = reorder(term, n)) %&gt;%
  ggplot(aes(term, n, fill = sentiment)) +
  geom_bar(stat = &quot;identity&quot;) +
  ggtitle(&quot;Contribution to sentiment&quot;) +
  coord_flip() + theme_fivethirtyeight()</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" width="576" /></p>
<p>Seems like bloody hell :) By the way, the word ‘start’ is actually the name of one dynasty. Starks are the family who rules the nordic lands in Westeros. So we will remove it form the sentiment in our next iteration.</p>
<pre class="r"><code>tidy(dtm_words_count) %&gt;%
  filter(document == 1) %&gt;%
  arrange(desc(count))</code></pre>
<pre><code>## # A tibble: 0 x 3
## # ... with 3 variables: document &lt;chr&gt;, term &lt;chr&gt;, count &lt;dbl&gt;</code></pre>
<p><b> 2018.24.02 </b></p>
<p>Today we are looking at a quick sentiment analysis of Game of Thrones novels</p>
<pre class="r"><code>Sentiment_Thrones &lt;- Thrones %&gt;%
  group_by(title) %&gt;%
  mutate(linenumber = row_number(), ignore_case = TRUE) %&gt;%
  ungroup() %&gt;%
  unnest_tokens(word, text) %&gt;%
  
  inner_join(get_sentiments(&quot;bing&quot;)) %&gt;%
  count(title, index = linenumber %/% 80, sentiment) %&gt;%
  spread(sentiment, n, fill = 0) %&gt;%
  mutate(sentiment = positive - negative) %&gt;%

  ggplot(aes(index, sentiment, fill = title)) +
  geom_col(show.legend = FALSE) +
  facet_wrap(~title, ncol = 2, scales = &quot;free_x&quot;) +
  theme_fivethirtyeight()

Sentiment_Thrones</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>We will research if such negativity is real… Can be… Everybody is dying afterall.</p>
<p><b> 2018.23.02 </b></p>
<p>Let’s have a look at Game of Thrones, 5 huge volumes</p>
<pre class="r"><code>GoT1 &lt;- readLines(&quot;GoT1.txt&quot;) %&gt;%
  data_frame() %&gt;%
  mutate(title = &quot;A Game of Thrones&quot;)

GoT2 &lt;- readLines(&quot;GoT2.txt&quot;) %&gt;%
  data_frame() %&gt;%
  mutate(title = &quot;A Clash of Kings&quot;) 

GoT3 &lt;- readLines(&quot;GoT3.txt&quot;) %&gt;%
  data_frame() %&gt;%
  mutate(title = &quot;A Storm of Swords&quot;) 

GoT4 &lt;- readLines(&quot;GoT4.txt&quot;) %&gt;%
  data_frame() %&gt;%
  mutate(title = &quot;A Feast of Crows&quot;) 

GoT5 &lt;- readLines(&quot;GoT5.txt&quot;) %&gt;%
  data_frame() %&gt;%
  mutate(title = &quot;A Dance with Dragons&quot;) 

Thrones &lt;- bind_rows(list(GoT1, GoT2, GoT3, GoT4, GoT5)) 
colnames(Thrones) &lt;- c(&quot;text&quot;, &quot;title&quot;)</code></pre>
<p>Convert to Tidy format</p>
<pre class="r"><code>Tidy_Thrones &lt;- Thrones %&gt;%
  unnest_tokens(word, text) %&gt;%
  anti_join(stop_words)</code></pre>
<p>Have a look at the top 10 words in these books</p>
<pre class="r"><code>Tidy_Thrones %&gt;%
  count(word, sort = TRUE) %&gt;%
  head(10)</code></pre>
<p>Looks like lots of lords, sirs and ladies around Jon Snow and Tyrion Lennister :)</p>
<pre class="r"><code>Tidy_Thrones %&gt;%
          count(word, sort = TRUE) %&gt;%
          filter(n &gt; 2300) %&gt;%
          mutate(word = reorder(word, n)) %&gt;%
          ggplot(aes(word, n)) + geom_col() + xlab(NULL) + coord_flip() +
          ggtitle(&quot;A Song of Ice and Fire&quot;) +
          theme_fivethirtyeight()</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" width="384" /></p>
<p>Now lets see tf-idf to see the most <strong>important</strong> words in these books.</p>
<pre class="r"><code>Tidy_Thrones &lt;- Tidy_Thrones %&gt;%
  anti_join(stop_words) %&gt;%
  count(title, word, sort = TRUE) %&gt;%
  ungroup()

Tidy_Thrones_total_words &lt;- Tidy_Thrones %&gt;% 
  group_by(title) %&gt;% 
  summarize(total = sum(n))

Tidy_Thrones &lt;- left_join(Tidy_Thrones, Tidy_Thrones_total_words)</code></pre>
<pre class="r"><code>Tidy_Thrones &lt;- Tidy_Thrones %&gt;%
  bind_tf_idf(word, title, n)
head(Tidy_Thrones)</code></pre>
<pre><code>## # A tibble: 6 x 7
##   title                word      n  total      tf   idf tf_idf
##   &lt;chr&gt;                &lt;chr&gt; &lt;int&gt;  &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1 A Storm of Swords    lord   1880 163031 0.0115      0      0
## 2 A Dance with Dragons lord   1541 166936 0.00923     0      0
## 3 A Feast of Crows     lord   1473 121855 0.0121      0      0
## 4 A Storm of Swords    ser    1468 163031 0.00900     0      0
## 5 A Clash of Kings     lord   1420 126874 0.0112      0      0
## 6 A Feast of Crows     ser    1391 121855 0.0114      0      0</code></pre>
<pre class="r"><code>Tidy_Thrones %&gt;%
  select(-total) %&gt;%
  arrange(desc(tf_idf)) %&gt;%
  head()</code></pre>
<pre><code>## # A tibble: 6 x 6
##   title                word         n       tf   idf   tf_idf
##   &lt;chr&gt;                &lt;chr&gt;    &lt;int&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
## 1 A Dance with Dragons griff      175 0.00105  1.61  0.00169 
## 2 A Dance with Dragons hizdahr    231 0.00138  0.916 0.00127 
## 3 A Feast of Crows     hyle        88 0.000722 1.61  0.00116 
## 4 A Dance with Dragons haldon     102 0.000611 1.61  0.000983
## 5 A Dance with Dragons gerris      93 0.000557 1.61  0.000897
## 6 A Feast of Crows     meribald    66 0.000542 1.61  0.000872</code></pre>
<pre class="r"><code>Tidy_Thrones %&gt;%
        arrange(desc(tf_idf)) %&gt;%
        mutate(word = factor(word, levels = rev(unique(word)))) %&gt;% 
        group_by(title) %&gt;% 
        top_n(10) %&gt;% 
        ungroup %&gt;%
        ggplot(aes(word, tf_idf, fill = title)) +
        geom_col(show.legend = FALSE) +
        labs(x = NULL, y = &quot;tf-idf&quot;) +
        facet_wrap(~title, ncol = 2, scales = &quot;free&quot;) +
        theme_fivethirtyeight() + ggtitle(&quot;A Song of Ice and Fire&quot;) +
        coord_flip()</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" width="768" /></p>
<p>Looks like I will need to do <strong>a bit</strong> cleaning :)</p>
<p><b> 2018.22.02 </b> A few days ago, I learnt that it is possible to keep a blog up and running using Github and RStudio from our instructor Eduardo Ariño de la Rubia.</p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
